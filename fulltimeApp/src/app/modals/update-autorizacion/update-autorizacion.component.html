<app-close-modal titleModal="Actualizar Autorización"></app-close-modal>

<ion-content>
  <ion-text mode="ios" color="dark" style="text-align: center; margin-top: 8px;">
    <h3>{{ labelAutorizacion }}</h3>
  </ion-text>

  <form #formRegistro="ngForm" *ngIf="showForm; else showMessageAutorizacion">

    <div class="Contenido" [hidden] = "ocultar">
      <ion-item  class="stilo_selection" color="horas_extras" >
        <ion-label position="floating">Autorización</ion-label>
        <ion-select mode="ios" interface="popover" style="color: rgb(0, 0, 0);" placeholder="Seleccione una opción" name="estado" (ngModel)="autorizacion.estado" (ionChange)="ChangeEstado($event)" required>
          <ion-select-option *ngFor="let e of estados" [value]="e.id"> {{ e.nombre }} </ion-select-option>
        </ion-select>
      </ion-item>
    </div>
    
    <ng-container *ngIf="permiso !== undefined">
      <app-show-permiso [permiso]="permiso"></app-show-permiso>
    </ng-container>
  
    <ng-container *ngIf="vacacion !== undefined">
      <app-show-vacacion [vacacion]="vacacion"></app-show-vacacion>
    </ng-container>
  
    <ng-container *ngIf="hora_extra !== undefined">
      <app-show-hora-extra [hora_extra]="hora_extra"> </app-show-hora-extra>
    </ng-container>

    <ng-container *ngIf="autorizacion !== undefined || autorizacion !== null">
      <ion-text mode="ios" color="dark" style="text-align: center;">
        <h5>Información de la Aprobación </h5>
      </ion-text>
      <div *ngIf="empleado_estado.length === 0; else todo" style="text-align: center;">
        <ion-card style="padding: 3% 1% 3% 1%; font-size: 12px;">
          <br>
          <ion-text color="primary">
            <span>Obteniendo Información Por favor Espere</span>
          </ion-text>
          <ion-progress-bar type="indeterminate"></ion-progress-bar>
          <br>
        </ion-card>
      </div>
      <ng-template #todo>
        <div style="margin: 3% 3% 7% 3%;">
          <ion-card style="padding: 3% 1% 3% 1%; font-size: 12px;">
            <div *ngIf="empleado_estado.length > 1">
              <ion-item *ngFor="let ea of empleado_estado" >
                <ion-avatar slot="start" *ngIf="ea != ','">
                  <ion-icon name="person-circle-outline" color="theme" style="font-size: 35px;"></ion-icon>
                </ion-avatar>
                <ion-text style="font-size: 85%;" *ngIf="ea != ','">
                  <p style="margin-top:12px; color: rgb(35, 173, 35);"><b> {{ea.estado}} por: </b></p> 
                  <p style="margin-top:-9px;">{{ea.nombre}} </p>
                </ion-text>
              </ion-item>
            </div>
            <div style="padding: 3% 1% 3% 1%; font-size: 12px; text-align: center;">
              <ion-label [color]="color">
                {{mensaje}}
              </ion-label>
            </div>
          </ion-card>
        </div>
      </ng-template>
    </ng-container>
    

    <!-- BOTON GUARDAR COMPONENTE -->
    <div style="margin: 3% 4% 3% 4%;" [hidden] = "ocultar">
      <button style="width: 100%; background-color: transparent;">
        <btn-update (onUpdate)="UpdateRegister()" [loadingBtn]="loadingBtn" [formRegistro]="formRegistro"></btn-update>
      </button>
    </div>
    
  </form>

  <ng-template #showMessageAutorizacion>
    <ion-text mode="ios" color="primary" style="text-align: center;">
      <br>
      <h3> No hay autorización para este registro de {{ labelAutorizacion | lowercase }} </h3>
      <br>
    </ion-text>
  </ng-template>

  <ng-container *ngIf="permiso === undefined && vacacion === undefined && hora_extra === undefined">
    <ion-text mode="ios" color="danger" style="text-align: center;">
      <br>
      <h3 style="margin: 0px 20px;"> No se puede procesar la información porque no coincide el código de empleado del
        registro de {{ labelAutorizacion | lowercase }} con los registros de empleados del sistema. </h3>
      <br>
    </ion-text>
  </ng-container>


</ion-content>